FROM ubuntu

# Install iptables and networking tools
RUN apt update && apt install -y iproute2 iptables curl && \
    apt clean && rm -rf /var/lib/apt/lists/*

# Copy the firewall configuration script
COPY firewall.sh /usr/local/bin/firewall.sh

# Make the script executable
RUN chmod +x /usr/local/bin/firewall.sh

# Enable IP forwarding at container start and run firewall script
CMD echo 1 > /proc/sys/net/ipv4/ip_forward && /usr/local/bin/firewall.sh && sleep infinity
